<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-11-03T18:06:22.2340836"><meta name="build-number" content="${buildNumber}">       <title>Data Preparation | MixMatch PyTorch Documentation</title><script id="virtual-toc-data" type="application/json">[{"id":"data-augmentation","level":0,"title":"Data Augmentation","anchor":"#data-augmentation"},{"id":"implementation","level":0,"title":"Implementation","anchor":"#implementation"}]</script><script id="topic-shortcuts" type="application/json"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Data Preparation | MixMatch PyTorch Documentation"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="MixMatch PyTorch Documentation Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="/d/1.0/data-preparation.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Data Preparation | MixMatch PyTorch Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "/d/1.0/data-preparation.html#webpage", "url": "/d/1.0/data-preparation.html", "name": "Data Preparation | MixMatch PyTorch Documentation", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "/d/#website", "url": "/d/", "name": "MixMatch PyTorch Documentation Help" }</script><!-- End Schema.org --> <!-- Mermaid light/dark themes -->  <link rel="stylesheet" type="text/css" href="mermaid.css">  </head>     <body data-id="Data-Preparation" data-main-title="Data Preparation" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Pipeline"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MixMatch PyTorch Documentation 1.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Data-Preparation"  id="Data-Preparation.md"  >Data Preparation</h1>  <p id="30be2bb8_5734">The data is split into 3 + K sets, where K is the number of augmentations.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 516.171875 344"  xmlns="http://www.w3.org/2000/svg" width="516.171875" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M29.991927083333334,210L41.35915798611111,177.83333333333334C52.72638888888889,145.66666666666666,75.46085069444445,81.33333333333333,98.54032118055557,49.166666666666664C121.61979166666667,17,145.04427083333334,17,156.75651041666666,17L168.46875,17"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-C" id="L-A-C-0" d="M39.003255208333336,210L48.86859809027778,198.83333333333334C58.73394097222223,187.66666666666666,78.46462673611111,165.33333333333334,100.17371961805554,154.16666666666666C121.8828125,143,145.5703125,143,157.4140625,143L169.2578125,143"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-D" id="L-A-D-0" d="M47.96875,227L56.33984375,227C64.7109375,227,81.453125,227,98.1953125,227C114.9375,227,131.6796875,227,140.05078125,227L148.421875,227"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-E" id="L-A-E-0" d="M39.003255208333336,244L48.86859809027778,255.16666666666666C58.73394097222223,266.3333333333333,78.46462673611111,288.6666666666667,100.24663628472221,299.8333333333333C122.02864583333333,311,145.86197916666666,311,157.77864583333334,311L169.6953125,311"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-F" id="L-B-F-0" d="M214.765625,17L227.54947916666666,17C240.33333333333334,17,265.9010416666667,17,289.8658854166667,17C313.8307291666667,17,336.1927083333333,17,347.3736979166667,17L358.5546875,17"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-G" id="L-C-G-0" d="M213.9765625,133.59510210468665L226.89192708333334,128.16258508723888C239.80729166666666,122.7300680697911,265.6380208333333,111.86503403489554,288.765625,106.43251701744778C311.8932291666667,101,332.3177083333333,101,342.5299479166667,101L352.7421875,101"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-H" id="L-C-H-0" d="M213.9765625,152.40489789531335L226.89192708333334,157.83741491276112C239.80729166666666,163.2699319302089,265.6380208333333,174.13496596510444,287.99609375,179.5674829825522C310.3541666666667,185,329.2395833333333,185,338.6822916666667,185L348.125,185"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-I" id="L-C-I-0" d="M205.08922371031747,160L219.4858114252646,178.16666666666666C233.88239914021165,196.33333333333334,262.6755745701058,232.66666666666666,287.2166935350529,250.83333333333334C311.7578125,269,332.046875,269,342.19140625,269L352.3359375,269"></path></g><g class="edgeLabels"><g transform="translate(98.1953125, 17)" class="edgeLabel"><g transform="translate(-25.2265625, -9.5)" class="label"><foreignObject height="19" width="50.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Shuffle</span></div></foreignObject></g></g><g transform="translate(98.1953125, 143)" class="edgeLabel"><g transform="translate(-25.2265625, -9.5)" class="label"><foreignObject height="19" width="50.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Shuffle</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(291.46875, 17)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.46875, 101)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.46875, 185)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.46875, 269)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(23.984375, 227)" id="flowchart-A-97592" class="node default default flowchart-label"><rect height="34" width="47.96875" y="-17" x="-23.984375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-16.484375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="32.96875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Data</span></div></foreignObject></g></g><g transform="translate(191.6171875, 17)" id="flowchart-B-97593" class="node default default flowchart-label"><rect height="34" width="46.296875" y="-17" x="-23.1484375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-15.6484375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="31.296875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab.</span></div></foreignObject></g></g><g transform="translate(191.6171875, 143)" id="flowchart-C-97595" class="node default default flowchart-label"><rect height="34" width="44.71875" y="-17" x="-22.359375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-14.859375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="29.71875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl.</span></div></foreignObject></g></g><g transform="translate(191.6171875, 227)" id="flowchart-D-97597" class="node default default flowchart-label"><rect height="34" width="86.390625" y="-17" x="-43.1953125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-35.6953125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="71.390625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Validation</span></div></foreignObject></g></g><g transform="translate(191.6171875, 311)" id="flowchart-E-97599" class="node default default flowchart-label"><rect height="34" width="43.84375" y="-17" x="-21.921875" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-14.421875, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="28.84375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Test</span></div></foreignObject></g></g><g transform="translate(424.1484375, 17)" id="flowchart-F-97601" class="node default default flowchart-label"><rect height="34" width="131.1875" y="-17" x="-65.59375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-58.09375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="116.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Augmented</span></div></foreignObject></g></g><g transform="translate(424.1484375, 101)" id="flowchart-G-97603" class="node default default flowchart-label"><rect height="34" width="142.8125" y="-17" x="-71.40625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-63.90625, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="127.8125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented 1</span></div></foreignObject></g></g><g transform="translate(424.1484375, 185)" id="flowchart-H-97605" class="node default default flowchart-label"><rect height="34" width="152.046875" y="-17" x="-76.0234375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-68.5234375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="137.046875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented ...</span></div></foreignObject></g></g><g transform="translate(424.1484375, 269)" id="flowchart-I-97607" class="node default default flowchart-label"><rect height="34" width="143.625" y="-17" x="-71.8125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-64.3125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="128.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented K</span></div></foreignObject></g></g></g></g></g></svg><p id="30be2bb8_5736">As our labelled data is tiny, it's important to stratify the data on the labels.</p><aside class="prompt" data-type="tip" data-title="" id="30be2bb8_5737"><p id="30be2bb8_5738">The implementation used K = 2.</p></aside><p id="30be2bb8_5739">It's up to the user to decide how to augment, how much labelled data to use, how much validation, etc.</p><section class="chapter"><h2 id="data-augmentation" data-toc="data-augmentation">Data Augmentation</h2><p id="30be2bb8_5740">The data augmentation is simple</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 677.015625 50"  xmlns="http://www.w3.org/2000/svg" width="677.015625" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M47.96875,17L52.135416666666664,17C56.302083333333336,17,64.63541666666667,17,72.96875,17C81.30208333333333,17,89.63541666666667,17,93.80208333333333,17L97.96875,17"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M173.421875,17L177.58854166666666,17C181.75520833333334,17,190.08854166666666,17,198.421875,17C206.75520833333334,17,215.08854166666666,17,219.25520833333334,17L223.421875,17"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M397.109375,17L401.2760416666667,17C405.4427083333333,17,413.7760416666667,17,422.109375,17C430.4427083333333,17,438.7760416666667,17,442.9427083333333,17L447.109375,17"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(23.984375, 17)" id="flowchart-A-97698" class="node default default flowchart-label"><rect height="34" width="47.96875" y="-17" x="-23.984375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-16.484375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="32.96875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Data</span></div></foreignObject></g></g><g transform="translate(135.6953125, 17)" id="flowchart-B-97699" class="node default default flowchart-label"><rect height="34" width="75.453125" y="-17" x="-37.7265625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-30.2265625, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="60.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">4 px Pad</span></div></foreignObject></g></g><g transform="translate(310.265625, 17)" id="flowchart-C-97701" class="node default default flowchart-label"><rect height="34" width="173.6875" y="-17" x="-86.84375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-79.34375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="158.6875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Random Crop 32x32px</span></div></foreignObject></g></g><g transform="translate(554.0625, 17)" id="flowchart-D-97703" class="node default default flowchart-label"><rect height="34" width="213.90625" y="-17" x="-106.953125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-99.453125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="198.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Random Horizontal Flip 50%</span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h2 id="implementation" data-toc="implementation">Implementation</h2><p id="30be2bb8_5742">We found some difficulty working with <code class="code" id="30be2bb8_5743">torchvision</code>'s CIFAR10 as the dataset is on-demand. We implement this approach, however, it's not the only way to do this.</p><p id="30be2bb8_5744">In order to stratify and shuffle the data without loading the entire dataset, we pass indices into the Dataset initialization, and pre-emptively shuffle and filter out the indices.</p><div class="code-block" data-lang="python"         >
from typing import Sequence

import numpy as np
from torchvision.datasets import CIFAR10


class CIFAR10Subset(CIFAR10):
    def __init__(self, idxs: Sequence[int], **kwargs):
        super().__init__(**kwargs)
        self.data = self.data[idxs]
        self.targets = np.array(self.targets)[idxs].tolist()
</div><p id="30be2bb8_5746">Notably, <code class="code" id="30be2bb8_5747">torchvision.datasets.CIFAR10</code> has</p><ul class="list _ul" id="30be2bb8_5748"    ><li class="list__item" id="30be2bb8_5749"><p>50,000 training images</p></li><li class="list__item" id="30be2bb8_5750"><p>10,000 test images</p></li></ul><p id="30be2bb8_5751">So, the process is to figure out how to split <code class="code" id="30be2bb8_5752">range(50000)</code> indices into the indices for the labelled and unlabelled data, furthermore, use the targets to stratify the data.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 961.44140625 626.606689453125" height="626.606689453125" xmlns="http://www.w3.org/2000/svg" width="961.44140625" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M463.58203125,144.8033561706543L463.58203125,148.97002283732095C463.58203125,153.13668950398764,463.58203125,161.47002283732095,469.4778335813492,169.8033561706543C475.3736359126984,178.13668950398764,487.1652405753968,186.47002283732095,493.061042906746,190.63668950398764L498.95684523809524,194.8033561706543"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-B" id="L-C-B-0" d="M757.921875,144.8033561706543L757.921875,148.97002283732095C757.921875,153.13668950398764,757.921875,161.47002283732095,725.1764322916666,171.49130479906387C692.4309895833334,181.51258676080678,626.9401041666666,193.22181735095924,594.1946614583334,199.07643264603553L561.44921875,204.93104794111176"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-C" id="L-D-C-0" d="M757.921875,60.8033561706543L757.921875,64.97002283732097C757.921875,69.13668950398763,757.921875,77.47002283732097,757.921875,85.8033561706543C757.921875,94.13668950398763,757.921875,102.47002283732097,757.921875,106.63668950398763L757.921875,110.8033561706543"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-U" id="L-B-U-0" d="M484.57421875,218.49571617972254L450.7760416666667,224.3803228448778C416.9778645833333,230.2649295100331,349.3815104166667,242.03414284034372,315.5833333333333,254.31902918638684C281.78515625,266.60391553243,281.78515625,279.40447489420575,281.78515625,285.80475457509357L281.78515625,292.20503425598145"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-L" id="L-B-L-0" d="M523.01171875,228.8033561706543L523.01171875,232.97002283732095C523.01171875,237.13668950398764,523.01171875,245.47002283732095,523.01171875,256.0369691848755C523.01171875,266.60391553243,523.01171875,279.40447489420575,523.01171875,285.80475457509357L523.01171875,292.20503425598145"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-V" id="L-B-V-0" d="M561.44921875,218.53167083593172L595.0325520833334,224.41028505838548C628.6158854166666,230.28889928083925,695.7825520833334,242.04612772574674,729.3658854166666,254.32502162908838C762.94921875,266.60391553243,762.94921875,279.40447489420575,762.94921875,285.80475457509357L762.94921875,292.20503425598145"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D1 LE-S1" id="L-D1-S1-0" d="M644.01953125,339.6067123413086L644.01953125,343.7733790079753C644.01953125,347.9400456746419,644.01953125,356.2733790079753,649.9188213045635,364.6067123413086C655.818111359127,372.9400456746419,667.616691468254,381.2733790079753,673.5159815228175,385.4400456746419L679.415271577381,389.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-V LE-S1" id="L-V-S1-0" d="M762.94921875,326.20503425598145L762.94921875,332.6053139368693C762.94921875,339.00559361775714,762.94921875,351.8061529795329,757.0499286954365,362.3730993270874C751.1506386408731,372.9400456746419,739.352058531746,381.2733790079753,733.4527684771825,385.4400456746419L727.553478422619,389.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D2 LE-S2" id="L-D2-S2-0" d="M83.7890625,339.6067123413086L83.7890625,343.7733790079753C83.7890625,347.9400456746419,83.7890625,356.2733790079753,95.07942708333333,365.0463293507442C106.36979166666667,373.8192796935132,128.95052083333334,383.03184704571777,140.24088541666666,387.6381307218201L151.53125,392.2444143979224"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-U LE-S2" id="L-U-S2-0" d="M281.78515625,326.20503425598145L281.78515625,332.6053139368693C281.78515625,339.00559361775714,281.78515625,351.8061529795329,271.810546875,362.6139039956445C261.8359375,373.4216550117562,241.88671875,382.2365976822037,231.912109375,386.64406901742746L221.9375,391.0515403526512"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D3 LE-S3" id="L-D3-S3-0" d="M402.00390625,339.6067123413086L402.00390625,343.7733790079753C402.00390625,347.9400456746419,402.00390625,356.2733790079753,408.0062779017857,364.6067123413086C414.0086495535714,372.9400456746419,426.01339285714283,381.2733790079753,432.0157645089285,385.4400456746419L438.0181361607143,389.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-S3" id="L-L-S3-0" d="M523.01171875,326.20503425598145L523.01171875,332.6053139368693C523.01171875,339.00559361775714,523.01171875,351.8061529795329,517.0093470982143,362.3730993270874C511.0069754464286,372.9400456746419,499.00223214285717,381.2733790079753,492.9998604910715,385.4400456746419L486.9974888392857,389.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S1 LE-VD" id="L-S1-VD-0" d="M703.484375,423.6067123413086L703.484375,427.7733790079753C703.484375,431.9400456746419,703.484375,440.2733790079753,703.484375,451.4400456746419C703.484375,462.6067123413086,703.484375,476.6067123413086,703.484375,492.1900456746419C703.484375,507.7733790079753,703.484375,524.940045674642,703.484375,539.2733790079752C703.484375,553.6067123413086,703.484375,565.1067123413086,703.484375,570.8567123413086L703.484375,576.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S2 LE-UD" id="L-S2-UD-0" d="M186.734375,423.6067123413086L186.734375,427.7733790079753C186.734375,431.9400456746419,186.734375,440.2733790079753,186.734375,448.6067123413086C186.734375,456.9400456746419,186.734375,465.2733790079753,186.734375,469.4400456746419L186.734375,473.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S3 LE-LD" id="L-S3-LD-0" d="M462.5078125,423.6067123413086L462.5078125,427.7733790079753C462.5078125,431.9400456746419,462.5078125,440.2733790079753,462.5078125,448.6067123413086C462.5078125,456.9400456746419,462.5078125,465.2733790079753,462.5078125,469.4400456746419L462.5078125,473.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDA1" id="L-UD-UDA1-0" d="M139.63106796116506,507.6067123413086L123.69906705097088,513.3567123413086C107.7670661407767,519.1067123413086,75.90306432038835,530.6067123413086,59.971063410194176,542.1067123413086C44.0390625,553.6067123413086,44.0390625,565.1067123413086,44.0390625,570.8567123413086L44.0390625,576.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDA" id="L-UD-UDA-0" d="M186.734375,507.6067123413086L186.734375,513.3567123413086C186.734375,519.1067123413086,186.734375,530.6067123413086,186.734375,542.1067123413086C186.734375,553.6067123413086,186.734375,565.1067123413086,186.734375,570.8567123413086L186.734375,576.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDAK" id="L-UD-UDAK-0" d="M233.97178398058253,507.6067123413086L249.94914290048544,513.3567123413086C265.92650182038835,519.1067123413086,297.8812196601942,530.6067123413086,313.8585785800971,542.1067123413086C329.8359375,553.6067123413086,329.8359375,565.1067123413086,329.8359375,570.8567123413086L329.8359375,576.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-LD LE-LDA" id="L-LD-LDA-0" d="M462.5078125,507.6067123413086L462.5078125,513.3567123413086C462.5078125,519.1067123413086,462.5078125,530.6067123413086,462.5078125,542.1067123413086C462.5078125,553.6067123413086,462.5078125,565.1067123413086,462.5078125,570.8567123413086L462.5078125,576.6067123413086"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DT LE-DTT" id="L-DT-DTT-0" d="M893.84765625,60.8033561706543L893.84765625,64.97002283732097C893.84765625,69.13668950398763,893.84765625,77.47002283732097,893.84765625,88.63668950398763C893.84765625,99.8033561706543,893.84765625,113.8033561706543,893.84765625,127.8033561706543C893.84765625,141.8033561706543,893.84765625,155.8033561706543,893.84765625,169.8033561706543C893.84765625,183.8033561706543,893.84765625,197.8033561706543,893.84765625,211.8033561706543C893.84765625,225.8033561706543,893.84765625,239.8033561706543,893.84765625,256.0369691848755C893.84765625,272.2705821990967,893.84765625,290.73780822753906,893.84765625,309.20503425598145C893.84765625,327.6722602844238,893.84765625,346.1394863128662,893.84765625,362.3730993270874C893.84765625,378.6067123413086,893.84765625,392.6067123413086,893.84765625,406.6067123413086C893.84765625,420.6067123413086,893.84765625,434.6067123413086,893.84765625,448.6067123413086C893.84765625,462.6067123413086,893.84765625,476.6067123413086,893.84765625,492.1900456746419C893.84765625,507.7733790079753,893.84765625,524.940045674642,893.84765625,539.2733790079752C893.84765625,553.6067123413086,893.84765625,565.1067123413086,893.84765625,570.8567123413086L893.84765625,576.6067123413086"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(44.0390625, 542.1067123413086)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(186.734375, 542.1067123413086)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(329.8359375, 542.1067123413086)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(462.5078125, 542.1067123413086)" class="edgeLabel"><g transform="translate(-31.65625, -9.5)" class="label"><foreignObject height="19" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(893.84765625, 309.20503425598145)" class="edgeLabel"><g transform="translate(-40.2890625, -9.5)" class="label"><foreignObject height="19" width="80.578125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Train=False</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(463.58203125, 127.8033561706543)" id="flowchart-A-97793" class="node default default flowchart-label"><rect height="34" width="71.21875" y="-17" x="-35.609375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-28.109375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="56.21875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">1-50000</span></div></foreignObject></g></g><g transform="translate(523.01171875, 211.8033561706543)" id="flowchart-B-97794" class="node default default flowchart-label"><rect height="34" width="76.875" y="-17" x="-38.4375" ry="17" rx="17" style=""></rect><g transform="translate(-26.6875, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="53.375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Stratify</span></div></foreignObject></g></g><g transform="translate(757.921875, 127.8033561706543)" id="flowchart-C-97795" class="node default default flowchart-label"><rect height="34" width="66.5" y="-17" x="-33.25" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-25.75, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="51.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Targets</span></div></foreignObject></g></g><g transform="translate(757.921875, 30.40167808532715)" id="flowchart-D-97797" class="node default default flowchart-label"><path transform="translate(-34.7578125,-30.401678849706805)" d="M 0,8.934452566471203 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 a 34.7578125,8.934452566471203 0,0,0 -69.515625 0 l 0,42.9344525664712 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 l 0,-42.9344525664712" style=""></path><g transform="translate(-27.2578125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="54.515625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(281.78515625, 309.20503425598145)" id="flowchart-U-97800" class="node default default flowchart-label"><rect height="34" width="70.921875" y="-17" x="-35.4609375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-27.9609375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="55.921875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Idx</span></div></foreignObject></g></g><g transform="translate(523.01171875, 309.20503425598145)" id="flowchart-L-97802" class="node default default flowchart-label"><rect height="34" width="72.5" y="-17" x="-36.25" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-28.75, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="57.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Idx</span></div></foreignObject></g></g><g transform="translate(762.94921875, 309.20503425598145)" id="flowchart-V-97804" class="node default default flowchart-label"><rect height="34" width="68.34375" y="-17" x="-34.171875" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-26.671875, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="53.34375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Val. Idx</span></div></foreignObject></g></g><g transform="translate(644.01953125, 309.20503425598145)" id="flowchart-D1-97805" class="node default default flowchart-label"><path transform="translate(-34.7578125,-30.401678849706805)" d="M 0,8.934452566471203 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 a 34.7578125,8.934452566471203 0,0,0 -69.515625 0 l 0,42.9344525664712 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 l 0,-42.9344525664712" style=""></path><g transform="translate(-27.2578125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="54.515625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(703.484375, 406.6067123413086)" id="flowchart-S1-97806" class="node default default flowchart-label"><rect height="34" width="70.40625" y="-17" x="-35.203125" ry="17" rx="17" style=""></rect><g transform="translate(-23.453125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="46.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(83.7890625, 309.20503425598145)" id="flowchart-D2-97809" class="node default default flowchart-label"><path transform="translate(-34.7578125,-30.401678849706805)" d="M 0,8.934452566471203 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 a 34.7578125,8.934452566471203 0,0,0 -69.515625 0 l 0,42.9344525664712 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 l 0,-42.9344525664712" style=""></path><g transform="translate(-27.2578125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="54.515625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(186.734375, 406.6067123413086)" id="flowchart-S2-97810" class="node default default flowchart-label"><rect height="34" width="70.40625" y="-17" x="-35.203125" ry="17" rx="17" style=""></rect><g transform="translate(-23.453125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="46.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(402.00390625, 309.20503425598145)" id="flowchart-D3-97813" class="node default default flowchart-label"><path transform="translate(-34.7578125,-30.401678849706805)" d="M 0,8.934452566471203 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 a 34.7578125,8.934452566471203 0,0,0 -69.515625 0 l 0,42.9344525664712 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 l 0,-42.9344525664712" style=""></path><g transform="translate(-27.2578125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="54.515625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(462.5078125, 406.6067123413086)" id="flowchart-S3-97814" class="node default default flowchart-label"><rect height="34" width="70.40625" y="-17" x="-35.203125" ry="17" rx="17" style=""></rect><g transform="translate(-23.453125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="46.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(703.484375, 593.6067123413086)" id="flowchart-VD-97818" class="node default default flowchart-label"><rect height="34" width="101.484375" y="-17" x="-50.7421875" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-43.2421875, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="86.484375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Val. Dataset</span></div></foreignObject></g></g><g transform="translate(186.734375, 490.6067123413086)" id="flowchart-UD-97820" class="node default default flowchart-label"><rect height="34" width="104.046875" y="-17" x="-52.0234375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-44.5234375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="89.046875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Dataset</span></div></foreignObject></g></g><g transform="translate(462.5078125, 490.6067123413086)" id="flowchart-LD-97822" class="node default default flowchart-label"><rect height="34" width="105.640625" y="-17" x="-52.8203125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-45.3203125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="90.640625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Dataset</span></div></foreignObject></g></g><g transform="translate(44.0390625, 593.6067123413086)" id="flowchart-UDA1-97824" class="node default default flowchart-label"><rect height="34" width="88.078125" y="-17" x="-44.0390625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-36.5390625, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="73.078125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug 1</span></div></foreignObject></g></g><g transform="translate(186.734375, 593.6067123413086)" id="flowchart-UDA-97826" class="node default default flowchart-label"><rect height="34" width="97.3125" y="-17" x="-48.65625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-41.15625, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="82.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug ...</span></div></foreignObject></g></g><g transform="translate(329.8359375, 593.6067123413086)" id="flowchart-UDAK-97828" class="node default default flowchart-label"><rect height="34" width="88.890625" y="-17" x="-44.4453125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-36.9453125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="73.890625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug K</span></div></foreignObject></g></g><g transform="translate(462.5078125, 593.6067123413086)" id="flowchart-LDA-97830" class="node default default flowchart-label"><rect height="34" width="76.453125" y="-17" x="-38.2265625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-30.7265625, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="61.453125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Aug</span></div></foreignObject></g></g><g transform="translate(893.84765625, 30.40167808532715)" id="flowchart-DT-97831" class="node default default flowchart-label"><path transform="translate(-34.7578125,-30.401678849706805)" d="M 0,8.934452566471203 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 a 34.7578125,8.934452566471203 0,0,0 -69.515625 0 l 0,42.9344525664712 a 34.7578125,8.934452566471203 0,0,0 69.515625 0 l 0,-42.9344525664712" style=""></path><g transform="translate(-27.2578125, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="54.515625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(893.84765625, 593.6067123413086)" id="flowchart-DTT-97832" class="node default default flowchart-label"><rect height="34" width="103.1875" y="-17" x="-51.59375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-44.09375, -9.5)" style="" class="label"><rect></rect><foreignObject height="19" width="88.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Test Dataset</span></div></foreignObject></g></g></g></g></g></svg><aside class="prompt" data-type="note" data-title="" id="30be2bb8_5754"><p id="30be2bb8_5755">In total, 5 datasets are created, however, this shouldn't impact performance as they are all on-demand. Also note that only the test dataset has Train=False, the rest are all True.</p></aside><section class="chapter"><h3 id="splitting-unlabelled-to-k-augmentations" data-toc="splitting-unlabelled-to-k-augmentations">Splitting Unlabelled to K Augmentations</h3><p id="30be2bb8_5756">Instead of trying to create K datasets, we create a single dataset, and make it return K augmented versions of the same image.</p><div class="code-block" data-lang="python"         >
from typing import Sequence, Callable


class CIFAR10SubsetKAug(CIFAR10Subset):
    def __init__(self, k_augs: int, aug: Callable, idxs: Sequence[int], 
                 **kwargs):
        super().__init__(idxs=idxs, **kwargs)
        self.k_augs = k_augs
        self.aug = aug

    def __getitem__(self, item):
        img, target = super().__getitem__(item)
        return tuple(self.aug(img) for _ in range(self.k_augs)), target
</div><p id="30be2bb8_5758">This works by overriding the <code class="code" id="30be2bb8_5759">__getitem__</code> method, and returning a tuple of augmented images. Take note to update all downstream code to handle this.</p></section></section><div class="last-modified"> Last modified: 03 November 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="pipeline.html">Pipeline</a>   <a class="navigation-links__next" href="interleaving.html">Interleaving</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.js"></script></body></html>
<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-11-07T14:49:01.2073901"><meta name="build-number" content="${buildNumber}">       <title>Data Preparation | MixMatch PyTorch Documentation</title><script id="virtual-toc-data" type="application/json">[{"id":"data-augmentation","level":0,"title":"Data Augmentation","anchor":"#data-augmentation"},{"id":"implementation","level":0,"title":"Implementation","anchor":"#implementation"}]</script><script id="topic-shortcuts" type="application/json"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Data Preparation | MixMatch PyTorch Documentation"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="MixMatch PyTorch Documentation Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="/d/1.0/data-preparation.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Data Preparation | MixMatch PyTorch Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "/d/1.0/data-preparation.html#webpage", "url": "/d/1.0/data-preparation.html", "name": "Data Preparation | MixMatch PyTorch Documentation", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "/d/#website", "url": "/d/", "name": "MixMatch PyTorch Documentation Help" }</script><!-- End Schema.org --> <!-- Mermaid light/dark themes -->  <link rel="stylesheet" type="text/css" href="mermaid.css">  </head>     <body data-id="Data-Preparation" data-main-title="Data Preparation" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Pipeline"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MixMatch PyTorch Documentation 1.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Data-Preparation"  id="Data-Preparation.md"  >Data Preparation</h1>  <p id="f345e17e_33">The data is split into 3 + K sets, where K is the number of augmentations.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 516.1875 341.29998779296875" height="341.29998779296875" xmlns="http://www.w3.org/2000/svg" width="516.1875" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M29.93212076455408,208.50000381469727L41.31114281242137,176.5333366394043C52.69016486028866,144.56666946411133,75.44820895602324,80.63333511352539,98.53973157609512,48.66666793823242C121.63125419616699,16.700000762939453,145.05625534057617,16.700000762939453,156.76875591278076,16.700000762939453L168.48125648498535,16.700000762939453"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-C" id="L-A-C-0" d="M38.849050194771436,208.50000381469727L48.7419173376025,197.38333702087402C58.63478448043356,186.26667022705078,78.4205187660957,164.0333366394043,100.15817795706316,152.91666984558105C121.8958371480306,141.8000030517578,145.58542124430338,141.8000030517578,157.4302132924398,141.8000030517578L169.27500534057617,141.8000030517578"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-D" id="L-A-D-0" d="M47.97500228881836,225.20000457763672L56.34687741597494,225.20000457763672C64.71875254313152,225.20000457763672,81.46250279744466,225.20000457763672,98.20625305175781,225.20000457763672C114.95000330607097,225.20000457763672,131.69375356038412,225.20000457763672,140.06562868754068,225.20000457763672L148.43750381469727,225.20000457763672"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-E" id="L-A-E-0" d="M38.849050194771436,241.90000534057617L48.7419173376025,253.0166721343994C58.63478448043356,264.13333892822266,78.4205187660957,286.36667251586914,100.2300532113763,297.4833393096924C122.0395876566569,308.6000061035156,145.872922261556,308.6000061035156,157.78958956400552,308.6000061035156L169.70625686645508,308.6000061035156"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-F" id="L-B-F-0" d="M214.7812557220459,16.700000762939453L227.56458950042725,16.700000762939453C240.3479232788086,16.700000762939453,265.9145908355713,16.700000762939453,289.8791748682658,16.700000762939453C313.84375890096027,16.700000762939453,336.2062594095866,16.700000762939453,347.3875096638997,16.700000762939453L358.5687599182129,16.700000762939453"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-G" id="L-C-G-0" d="M213.98750686645508,132.46344168469375L226.90313212076822,127.06953511871451C239.8187573750814,121.67562855273529,265.6500078837077,110.88781542077682,288.778133392334,105.4939088547976C311.90625890096027,100.10000228881836,332.3312594095866,100.10000228881836,342.5437596638997,100.10000228881836L352.7562599182129,100.10000228881836"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-H" id="L-C-H-0" d="M213.98750686645508,151.13656441882188L226.90313212076822,156.5304709848011C239.8187573750814,161.92437755078035,265.6500078837077,172.7121906827388,288.0083414713542,178.10609724871802C310.36667505900067,183.50000381469727,329.2520917256673,183.50000381469727,338.69480005900067,183.50000381469727L348.137508392334,183.50000381469727"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-I" id="L-C-I-0" d="M204.9605533368844,158.50000381469727L219.380670846126,176.5666707356771C233.8007883553676,194.6333376566569,262.6410233738508,230.76667149861655,287.20593280407223,248.83333841959634C311.77084223429364,266.9000053405762,332.06042607625324,266.9000053405762,342.2052179972331,266.9000053405762L352.3500099182129,266.9000053405762"></path></g><g class="edgeLabels"><g transform="translate(98.20625305175781, 16.700000762939453)" class="edgeLabel"><g transform="translate(-25.231250762939453, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="50.462501525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Shuffle</span></div></foreignObject></g></g><g transform="translate(98.20625305175781, 141.8000030517578)" class="edgeLabel"><g transform="translate(-25.231250762939453, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="50.462501525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Shuffle</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(291.481258392334, 16.700000762939453)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.481258392334, 100.10000228881836)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.481258392334, 183.50000381469727)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.481258392334, 266.9000053405762)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(23.98750114440918, 225.20000457763672)" id="flowchart-A-2360" class="node default default flowchart-label"><rect height="33.39999961853027" width="47.97500228881836" y="-16.699999809265137" x="-23.98750114440918" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-16.48750114440918, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="32.97500228881836"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Data</span></div></foreignObject></g></g><g transform="translate(191.63125610351562, 16.700000762939453)" id="flowchart-B-2361" class="node default default flowchart-label"><rect height="33.39999961853027" width="46.30000114440918" y="-16.699999809265137" x="-23.15000057220459" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-15.65000057220459, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="31.30000114440918"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab.</span></div></foreignObject></g></g><g transform="translate(191.63125610351562, 141.8000030517578)" id="flowchart-C-2363" class="node default default flowchart-label"><rect height="33.39999961853027" width="44.71249961853027" y="-16.699999809265137" x="-22.356249809265137" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-14.856249809265137, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="29.712499618530273"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl.</span></div></foreignObject></g></g><g transform="translate(191.63125610351562, 225.20000457763672)" id="flowchart-D-2365" class="node default default flowchart-label"><rect height="33.39999961853027" width="86.38750457763672" y="-16.699999809265137" x="-43.19375228881836" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-35.69375228881836, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="71.38750457763672"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Validation</span></div></foreignObject></g></g><g transform="translate(191.63125610351562, 308.6000061035156)" id="flowchart-E-2367" class="node default default flowchart-label"><rect height="33.39999961853027" width="43.85000038146973" y="-16.699999809265137" x="-21.925000190734863" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-14.425000190734863, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="28.850000381469727"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Test</span></div></foreignObject></g></g><g transform="translate(424.1625099182129, 16.700000762939453)" id="flowchart-F-2369" class="node default default flowchart-label"><rect height="33.39999961853027" width="131.1875" y="-16.699999809265137" x="-65.59375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-58.09375, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="116.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Augmented</span></div></foreignObject></g></g><g transform="translate(424.1625099182129, 100.10000228881836)" id="flowchart-G-2371" class="node default default flowchart-label"><rect height="33.39999961853027" width="142.8125" y="-16.699999809265137" x="-71.40625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-63.90625, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="127.8125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented 1</span></div></foreignObject></g></g><g transform="translate(424.1625099182129, 183.50000381469727)" id="flowchart-H-2373" class="node default default flowchart-label"><rect height="33.39999961853027" width="152.0500030517578" y="-16.699999809265137" x="-76.0250015258789" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-68.5250015258789, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="137.0500030517578"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented ...</span></div></foreignObject></g></g><g transform="translate(424.1625099182129, 266.9000053405762)" id="flowchart-I-2375" class="node default default flowchart-label"><rect height="33.39999961853027" width="143.625" y="-16.699999809265137" x="-71.8125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-64.3125, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="128.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented K</span></div></foreignObject></g></g></g></g></g></svg><p id="f345e17e_35">As our labelled data is tiny, it's important to stratify the data on the labels.</p><aside class="prompt" data-type="tip" data-title="" id="f345e17e_36"><p id="f345e17e_37">The implementation used K = 2.</p></aside><p id="f345e17e_38">It's up to the user to decide how to augment, how much labelled data to use, how much validation, etc.</p><section class="chapter"><h2 id="data-augmentation" data-toc="data-augmentation">Data Augmentation</h2><p id="f345e17e_39">The data augmentation is simple</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 677.0374755859375 49.400001525878906" height="49.400001525878906" xmlns="http://www.w3.org/2000/svg" width="677.0374755859375" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M47.97500228881836,16.700000762939453L52.141668955485024,16.700000762939453C56.308335622151695,16.700000762939453,64.64166895548503,16.700000762939453,72.97500228881836,16.700000762939453C81.30833562215169,16.700000762939453,89.64166895548503,16.700000762939453,93.80833562215169,16.700000762939453L97.97500228881836,16.700000762939453"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M173.43750381469727,16.700000762939453L177.60417048136392,16.700000762939453C181.7708371480306,16.700000762939453,190.10417048136392,16.700000762939453,198.43750381469727,16.700000762939453C206.7708371480306,16.700000762939453,215.10417048136392,16.700000762939453,219.2708371480306,16.700000762939453L223.43750381469727,16.700000762939453"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M397.12500381469727,16.700000762939453L401.29167048136395,16.700000762939453C405.4583371480306,16.700000762939453,413.79167048136395,16.700000762939453,422.12500381469727,16.700000762939453C430.4583371480306,16.700000762939453,438.79167048136395,16.700000762939453,442.9583371480306,16.700000762939453L447.12500381469727,16.700000762939453"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(23.98750114440918, 16.700000762939453)" id="flowchart-A-2466" class="node default default flowchart-label"><rect height="33.39999961853027" width="47.97500228881836" y="-16.699999809265137" x="-23.98750114440918" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-16.48750114440918, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="32.97500228881836"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Data</span></div></foreignObject></g></g><g transform="translate(135.7062530517578, 16.700000762939453)" id="flowchart-B-2467" class="node default default flowchart-label"><rect height="33.39999961853027" width="75.4625015258789" y="-16.699999809265137" x="-37.73125076293945" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-30.231250762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="60.462501525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">4 px Pad</span></div></foreignObject></g></g><g transform="translate(310.28125381469727, 16.700000762939453)" id="flowchart-C-2469" class="node default default flowchart-label"><rect height="33.39999961853027" width="173.6875" y="-16.699999809265137" x="-86.84375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-79.34375, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="158.6875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Random Crop 32x32px</span></div></foreignObject></g></g><g transform="translate(554.0812568664551, 16.700000762939453)" id="flowchart-D-2471" class="node default default flowchart-label"><rect height="33.39999961853027" width="213.91250610351562" y="-16.699999809265137" x="-106.95625305175781" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-99.45625305175781, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="198.91250610351562"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Random Horizontal Flip 50%</span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h2 id="implementation" data-toc="implementation">Implementation</h2><p id="f345e17e_41">We found some difficulty working with <code class="code" id="f345e17e_42">torchvision</code>'s CIFAR10 as the dataset is on-demand. We implement this approach, however, it's not the only way to do this.</p><p id="f345e17e_43">In order to stratify and shuffle the data without loading the entire dataset, we pass indices into the Dataset initialization, and pre-emptively shuffle and filter out the indices.</p><div class="code-block" data-lang="python"         >
from typing import Sequence

import numpy as np
from torchvision.datasets import CIFAR10


class CIFAR10Subset(CIFAR10):
    def __init__(self, idxs: Sequence[int], **kwargs):
        super().__init__(**kwargs)
        self.data = self.data[idxs]
        self.targets = np.array(self.targets)[idxs].tolist()
</div><p id="f345e17e_45">Notably, <code class="code" id="f345e17e_46">torchvision.datasets.CIFAR10</code> has</p><ul class="list _ul" id="f345e17e_47"    ><li class="list__item" id="f345e17e_48"><p>50,000 training images</p></li><li class="list__item" id="f345e17e_49"><p>10,000 test images</p></li></ul><p id="f345e17e_50">So, the process is to figure out how to split <code class="code" id="f345e17e_51">range(50000)</code> indices into the indices for the labelled and unlabelled data, furthermore, use the targets to stratify the data.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 961.4656372070312 621.8114013671875" height="621.8114013671875" xmlns="http://www.w3.org/2000/svg" width="961.4656372070312" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M463.5875053405762,143.60568237304688L463.5875053405762,147.77234903971353C463.5875053405762,151.93901570638022,463.5875053405762,160.27234903971353,469.5258794943713,168.60568237304688C475.46425364816633,176.93901570638022,487.3410019557566,185.27234903971353,493.2793761095517,189.43901570638022L499.21775026334683,193.60568237304688"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-B" id="L-C-B-0" d="M757.9406299591064,143.60568237304688L757.9406299591064,147.77234903971353C757.9406299591064,151.93901570638022,757.9406299591064,160.27234903971353,725.1807339986166,170.25408800029172C692.4208380381266,180.2358269608699,626.9010461171468,191.86597154869295,594.1411501566569,197.68104384260448L561.381254196167,203.496116136516"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-C" id="L-D-C-0" d="M757.9406299591064,60.20568084716797L757.9406299591064,64.37234751383464C757.9406299591064,68.5390141805013,757.9406299591064,76.87234751383464,757.9406299591064,85.20568084716797C757.9406299591064,93.5390141805013,757.9406299591064,101.87234751383464,757.9406299591064,106.0390141805013L757.9406299591064,110.20568084716797"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-U" id="L-B-U-0" d="M484.6562557220459,216.93697481831845L450.843755086263,222.78175966508635C417.03125445048016,228.62654451185423,349.40625317891437,240.31611420539002,315.59375254313153,252.56137232893198C281.78125190734863,264.80663045247394,281.78125190734863,277.60757700602215,281.78125190734863,284.0080502827962L281.78125190734863,290.4085235595703"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-L" id="L-B-L-0" d="M523.0187549591064,227.00568389892578L523.0187549591064,231.17235056559244C523.0187549591064,235.33901723225912,523.0187549591064,243.67235056559244,523.0187549591064,254.2394905090332C523.0187549591064,264.80663045247394,523.0187549591064,277.60757700602215,523.0187549591064,284.0080502827962L523.0187549591064,290.4085235595703"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-V" id="L-B-V-0" d="M561.381254196167,216.9725564111156L594.9791711171468,222.8114109924173C628.5770880381266,228.650265573719,695.7729218800863,240.3279747363224,729.370838801066,252.56730259439817C762.9687557220459,264.80663045247394,762.9687557220459,277.60757700602215,762.9687557220459,284.0080502827962L762.9687557220459,290.4085235595703"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D1 LE-S1" id="L-D1-S1-0" d="M644.0312557220459,337.21136474609375L644.0312557220459,341.37803141276044C644.0312557220459,345.54469807942706,644.0312557220459,353.87803141276044,649.9733769162871,362.21136474609375C655.9154981105281,370.54469807942706,667.7997404990103,378.87803141276044,673.7418616932515,383.04469807942706L679.6839828874926,387.21136474609375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-V LE-S1" id="L-V-S1-0" d="M762.9687557220459,323.8085250854492L762.9687557220459,330.2089983622233C762.9687557220459,336.6094716389974,762.9687557220459,349.4104181925456,757.0266345278047,359.9775581359863C751.0845133335637,370.54469807942706,739.2002709450813,378.87803141276044,733.2581497508404,383.04469807942706L727.3160285565992,387.21136474609375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D2 LE-S2" id="L-D2-S2-0" d="M83.77812576293945,337.21136474609375L83.77812576293945,341.37803141276044C83.77812576293945,345.54469807942706,83.77812576293945,353.87803141276044,95.08281389872234,362.62353418974493C106.3875020345052,371.3690369667294,128.99687830607095,380.52670918736504,140.30156644185385,385.1055452976829L151.60625457763672,389.6843814080007"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-U LE-S2" id="L-U-S2-0" d="M281.78125190734863,323.8085250854492L281.78125190734863,330.2089983622233C281.78125190734863,336.6094716389974,281.78125190734863,349.4104181925456,271.79375235239667,360.1925721717048C261.80625279744464,370.974726150864,241.83125368754068,379.7380875556342,231.8437541325887,384.11976825801935L221.85625457763672,388.50144896040445"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D3 LE-S3" id="L-D3-S3-0" d="M402.006254196167,337.21136474609375L402.006254196167,341.37803141276044C402.006254196167,345.54469807942706,402.006254196167,353.87803141276044,408.0520424929748,362.21136474609375C414.0978307897826,370.54469807942706,426.1894073833983,378.87803141276044,432.2351956802061,383.04469807942706L438.280983977014,387.21136474609375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-S3" id="L-L-S3-0" d="M523.0187549591064,323.8085250854492L523.0187549591064,330.2089983622233C523.0187549591064,336.6094716389974,523.0187549591064,349.4104181925456,516.9729666622986,359.9775581359863C510.9271783654908,370.54469807942706,498.83560177187513,378.87803141276044,492.7898134750673,383.04469807942706L486.74402517825945,387.21136474609375"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S1 LE-VD" id="L-S1-VD-0" d="M703.5000057220459,420.61136627197266L703.5000057220459,424.77803293863934C703.5000057220459,428.94469960530597,703.5000057220459,437.27803293863934,703.5000057220459,448.3946997324626C703.5000057220459,459.5113665262858,703.5000057220459,473.41136678059894,703.5000057220459,488.8447003364563C703.5000057220459,504.27803389231366,703.5000057220459,521.2447007497152,703.5000057220459,535.4280341466268C703.5000057220459,549.6113675435384,703.5000057220459,561.0113674799601,703.5000057220459,566.711367448171L703.5000057220459,572.4113674163818"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S2 LE-UD" id="L-S2-UD-0" d="M186.73125457763672,420.61136627197266L186.73125457763672,424.77803293863934C186.73125457763672,428.94469960530597,186.73125457763672,437.27803293863934,186.73125457763672,445.61136627197266C186.73125457763672,453.94469960530597,186.73125457763672,462.27803293863934,186.73125457763672,466.44469960530597L186.73125457763672,470.61136627197266"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S3 LE-LD" id="L-S3-LD-0" d="M462.5125045776367,420.61136627197266L462.5125045776367,424.77803293863934C462.5125045776367,428.94469960530597,462.5125045776367,437.27803293863934,462.5125045776367,445.61136627197266C462.5125045776367,453.94469960530597,462.5125045776367,462.27803293863934,462.5125045776367,466.44469960530597L462.5125045776367,470.61136627197266"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDA1" id="L-UD-UDA1-0" d="M139.9142458290895,504.01136779785156L123.93478857237766,509.71136776606244C107.95533131566579,515.4113677342733,75.99641680224208,526.811367670695,60.01695954553022,538.2113676071167C44.03750228881836,549.6113675435384,44.03750228881836,561.0113674799601,44.03750228881836,566.711367448171L44.03750228881836,572.4113674163818"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDA" id="L-UD-UDA-0" d="M186.73125457763672,504.01136779785156L186.73125457763672,509.71136776606244C186.73125457763672,515.4113677342733,186.73125457763672,526.811367670695,186.73125457763672,538.2113676071167C186.73125457763672,549.6113675435384,186.73125457763672,561.0113674799601,186.73125457763672,566.711367448171L186.73125457763672,572.4113674163818"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDAK" id="L-UD-UDAK-0" d="M233.6836017300168,504.01136779785156L249.7092523317767,509.71136776606244C265.7349029335366,515.4113677342733,297.78620413705636,526.811367670695,313.8118547388163,538.2113676071167C329.8375053405762,549.6113675435384,329.8375053405762,561.0113674799601,329.8375053405762,566.711367448171L329.8375053405762,572.4113674163818"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-LD LE-LDA" id="L-LD-LDA-0" d="M462.5125045776367,504.01136779785156L462.5125045776367,509.71136776606244C462.5125045776367,515.4113677342733,462.5125045776367,526.811367670695,462.5125045776367,538.2113676071167C462.5125045776367,549.6113675435384,462.5125045776367,561.0113674799601,462.5125045776367,566.711367448171L462.5125045776367,572.4113674163818"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DT LE-DTT" id="L-DT-DTT-0" d="M893.8718814849854,60.20568084716797L893.8718814849854,64.37234751383464C893.8718814849854,68.5390141805013,893.8718814849854,76.87234751383464,893.8718814849854,87.98901430765788C893.8718814849854,99.10568110148112,893.8718814849854,113.00568135579427,893.8718814849854,126.90568161010742C893.8718814849854,140.80568186442056,893.8718814849854,154.70568211873373,893.8718814849854,168.60568237304688C893.8718814849854,182.50568262736002,893.8718814849854,196.4056828816732,893.8718814849854,210.30568313598633C893.8718814849854,224.20568339029947,893.8718814849854,238.10568364461264,893.8718814849854,254.2394905090332C893.8718814849854,270.3732973734538,893.8718814849854,288.74091084798175,893.8718814849854,307.10852432250977C893.8718814849854,325.4761377970378,893.8718814849854,343.84375127156574,893.8718814849854,359.9775581359863C893.8718814849854,376.1113650004069,893.8718814849854,390.01136525472003,893.8718814849854,403.9113655090332C893.8718814849854,417.8113657633464,893.8718814849854,431.7113660176595,893.8718814849854,445.61136627197266C893.8718814849854,459.5113665262858,893.8718814849854,473.41136678059894,893.8718814849854,488.8447003364563C893.8718814849854,504.27803389231366,893.8718814849854,521.2447007497152,893.8718814849854,535.4280341466268C893.8718814849854,549.6113675435384,893.8718814849854,561.0113674799601,893.8718814849854,566.711367448171L893.8718814849854,572.4113674163818"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(44.03750228881836, 538.2113676071167)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(186.73125457763672, 538.2113676071167)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(329.8375053405762, 538.2113676071167)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(462.5125045776367, 538.2113676071167)" class="edgeLabel"><g transform="translate(-31.65625, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(893.8718814849854, 307.10852432250977)" class="edgeLabel"><g transform="translate(-40.29375076293945, -9.199999809265137)" class="label"><foreignObject height="18.399999618530273" width="80.5875015258789"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Train=False</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(463.5875053405762, 126.90568161010742)" id="flowchart-A-2561" class="node default default flowchart-label"><rect height="33.39999961853027" width="71.22500228881836" y="-16.699999809265137" x="-35.61250114440918" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-28.11250114440918, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="56.22500228881836"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">1-50000</span></div></foreignObject></g></g><g transform="translate(523.0187549591064, 210.30568313598633)" id="flowchart-B-2562" class="node default default flowchart-label"><rect height="33.39999961853027" width="76.72499990463257" y="-16.699999809265137" x="-38.362499952316284" ry="16.699999809265137" rx="16.699999809265137" style=""></rect><g transform="translate(-26.6875, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="53.375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Stratify</span></div></foreignObject></g></g><g transform="translate(757.9406299591064, 126.90568161010742)" id="flowchart-C-2563" class="node default default flowchart-label"><rect height="33.39999961853027" width="66.5" y="-16.699999809265137" x="-33.25" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-25.75, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="51.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Targets</span></div></foreignObject></g></g><g transform="translate(757.9406299591064, 30.102840423583984)" id="flowchart-D-2565" class="node default default flowchart-label"><path transform="translate(-34.76250076293945,-30.102840250181973)" d="M 0,8.935226960611224 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 a 34.76250076293945,8.935226960611224 0,0,0 -69.5250015258789 0 l 0,42.3352265791415 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 l 0,-42.3352265791415" style=""></path><g transform="translate(-27.262500762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="54.525001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(281.78125190734863, 307.10852432250977)" id="flowchart-U-2568" class="node default default flowchart-label"><rect height="33.39999961853027" width="70.92499923706055" y="-16.699999809265137" x="-35.46249961853027" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-27.962499618530273, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="55.92499923706055"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Idx</span></div></foreignObject></g></g><g transform="translate(523.0187549591064, 307.10852432250977)" id="flowchart-L-2570" class="node default default flowchart-label"><rect height="33.39999961853027" width="72.5" y="-16.699999809265137" x="-36.25" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-28.75, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="57.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Idx</span></div></foreignObject></g></g><g transform="translate(762.9687557220459, 307.10852432250977)" id="flowchart-V-2572" class="node default default flowchart-label"><rect height="33.39999961853027" width="68.35000228881836" y="-16.699999809265137" x="-34.17500114440918" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-26.67500114440918, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="53.35000228881836"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Val. Idx</span></div></foreignObject></g></g><g transform="translate(644.0312557220459, 307.10852432250977)" id="flowchart-D1-2573" class="node default default flowchart-label"><path transform="translate(-34.76250076293945,-30.102840250181973)" d="M 0,8.935226960611224 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 a 34.76250076293945,8.935226960611224 0,0,0 -69.5250015258789 0 l 0,42.3352265791415 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 l 0,-42.3352265791415" style=""></path><g transform="translate(-27.262500762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="54.525001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(703.5000057220459, 403.9113655090332)" id="flowchart-S1-2574" class="node default default flowchart-label"><rect height="33.39999961853027" width="70.25000143051147" y="-16.699999809265137" x="-35.12500071525574" ry="16.699999809265137" rx="16.699999809265137" style=""></rect><g transform="translate(-23.450000762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="46.900001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(83.77812576293945, 307.10852432250977)" id="flowchart-D2-2577" class="node default default flowchart-label"><path transform="translate(-34.76250076293945,-30.102840250181973)" d="M 0,8.935226960611224 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 a 34.76250076293945,8.935226960611224 0,0,0 -69.5250015258789 0 l 0,42.3352265791415 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 l 0,-42.3352265791415" style=""></path><g transform="translate(-27.262500762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="54.525001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(186.73125457763672, 403.9113655090332)" id="flowchart-S2-2578" class="node default default flowchart-label"><rect height="33.39999961853027" width="70.25000143051147" y="-16.699999809265137" x="-35.12500071525574" ry="16.699999809265137" rx="16.699999809265137" style=""></rect><g transform="translate(-23.450000762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="46.900001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(402.006254196167, 307.10852432250977)" id="flowchart-D3-2581" class="node default default flowchart-label"><path transform="translate(-34.76250076293945,-30.102840250181973)" d="M 0,8.935226960611224 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 a 34.76250076293945,8.935226960611224 0,0,0 -69.5250015258789 0 l 0,42.3352265791415 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 l 0,-42.3352265791415" style=""></path><g transform="translate(-27.262500762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="54.525001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(462.5125045776367, 403.9113655090332)" id="flowchart-S3-2582" class="node default default flowchart-label"><rect height="33.39999961853027" width="70.25000143051147" y="-16.699999809265137" x="-35.12500071525574" ry="16.699999809265137" rx="16.699999809265137" style=""></rect><g transform="translate(-23.450000762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="46.900001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(703.5000057220459, 589.1113681793213)" id="flowchart-VD-2586" class="node default default flowchart-label"><rect height="33.39999961853027" width="101.48750305175781" y="-16.699999809265137" x="-50.743751525878906" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-43.243751525878906, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="86.48750305175781"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Val. Dataset</span></div></foreignObject></g></g><g transform="translate(186.73125457763672, 487.3113670349121)" id="flowchart-UD-2588" class="node default default flowchart-label"><rect height="33.39999961853027" width="104.05000305175781" y="-16.699999809265137" x="-52.025001525878906" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-44.525001525878906, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="89.05000305175781"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Dataset</span></div></foreignObject></g></g><g transform="translate(462.5125045776367, 487.3113670349121)" id="flowchart-LD-2590" class="node default default flowchart-label"><rect height="33.39999961853027" width="105.63750457763672" y="-16.699999809265137" x="-52.81875228881836" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-45.31875228881836, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="90.63750457763672"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Dataset</span></div></foreignObject></g></g><g transform="translate(44.03750228881836, 589.1113681793213)" id="flowchart-UDA1-2592" class="node default default flowchart-label"><rect height="33.39999961853027" width="88.07500457763672" y="-16.699999809265137" x="-44.03750228881836" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-36.53750228881836, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="73.07500457763672"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug 1</span></div></foreignObject></g></g><g transform="translate(186.73125457763672, 589.1113681793213)" id="flowchart-UDA-2594" class="node default default flowchart-label"><rect height="33.39999961853027" width="97.3125" y="-16.699999809265137" x="-48.65625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-41.15625, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="82.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug ...</span></div></foreignObject></g></g><g transform="translate(329.8375053405762, 589.1113681793213)" id="flowchart-UDAK-2596" class="node default default flowchart-label"><rect height="33.39999961853027" width="88.9000015258789" y="-16.699999809265137" x="-44.45000076293945" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-36.95000076293945, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="73.9000015258789"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug K</span></div></foreignObject></g></g><g transform="translate(462.5125045776367, 589.1113681793213)" id="flowchart-LDA-2598" class="node default default flowchart-label"><rect height="33.39999961853027" width="76.45000076293945" y="-16.699999809265137" x="-38.22500038146973" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-30.725000381469727, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="61.45000076293945"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Aug</span></div></foreignObject></g></g><g transform="translate(893.8718814849854, 30.102840423583984)" id="flowchart-DT-2599" class="node default default flowchart-label"><path transform="translate(-34.76250076293945,-30.102840250181973)" d="M 0,8.935226960611224 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 a 34.76250076293945,8.935226960611224 0,0,0 -69.5250015258789 0 l 0,42.3352265791415 a 34.76250076293945,8.935226960611224 0,0,0 69.5250015258789 0 l 0,-42.3352265791415" style=""></path><g transform="translate(-27.262500762939453, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="54.525001525878906"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(893.8718814849854, 589.1113681793213)" id="flowchart-DTT-2600" class="node default default flowchart-label"><rect height="33.39999961853027" width="103.1875" y="-16.699999809265137" x="-51.59375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-44.09375, -9.199999809265137)" style="" class="label"><rect></rect><foreignObject height="18.399999618530273" width="88.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Test Dataset</span></div></foreignObject></g></g></g></g></g></svg><aside class="prompt" data-type="note" data-title="" id="f345e17e_53"><p id="f345e17e_54">In total, 5 datasets are created, however, this shouldn't impact performance as they are all on-demand. Also note that only the test dataset has Train=False, the rest are all True.</p></aside><section class="chapter"><h3 id="splitting-unlabelled-to-k-augmentations" data-toc="splitting-unlabelled-to-k-augmentations">Splitting Unlabelled to K Augmentations</h3><p id="f345e17e_55">Instead of trying to create K datasets, we create a single dataset, and make it return K augmented versions of the same image.</p><div class="code-block" data-lang="python"         >
from typing import Sequence, Callable


class CIFAR10SubsetKAug(CIFAR10Subset):
    def __init__(self, k_augs: int, aug: Callable, idxs: Sequence[int], 
                 **kwargs):
        super().__init__(idxs=idxs, **kwargs)
        self.k_augs = k_augs
        self.aug = aug

    def __getitem__(self, item):
        img, target = super().__getitem__(item)
        return tuple(self.aug(img) for _ in range(self.k_augs)), target
</div><p id="f345e17e_57">This works by overriding the <code class="code" id="f345e17e_58">__getitem__</code> method, and returning a tuple of augmented images. Take note to update all downstream code to handle this.</p></section></section><div class="last-modified"> Last modified: 07 November 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="pipeline.html">Pipeline</a>   <a class="navigation-links__next" href="interleaving.html">Interleaving</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.js"></script></body></html>
<!DOCTYPE html SYSTEM "about:legacy-compat"><html lang="en-US" data-colors-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="robots" content="noindex">  <meta name="built-on" content="2023-11-26T23:41:05.7059438"><meta name="build-number" content="${buildNumber}">       <title>Data Preparation | MixMatch PyTorch Documentation</title><script id="virtual-toc-data" type="application/json">[{"id":"data-augmentation","level":0,"title":"Data Augmentation","anchor":"#data-augmentation"},{"id":"implementation","level":0,"title":"Implementation","anchor":"#implementation"}]</script><script id="topic-shortcuts" type="application/json"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.css" rel="stylesheet">   <link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><link rel="manifest" href="https://jetbrains.com/site.webmanifest"><link rel="mask-icon" href="https://jetbrains.com/safari-pinned-tab.svg" color="#000000"><meta name="msapplication-TileColor" content="#000000"/><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"/><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"/><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"/><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"/><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"/>  <meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Data Preparation | MixMatch PyTorch Documentation"/><meta property="og:description" content=""/><meta property="og:image" content=""/><meta property="og:site_name" content="MixMatch PyTorch Documentation Help"/><meta property="og:type" content="website"/><meta property="og:locale" content="en_US"/><meta property="og:url" content="/d/1.0/data-preparation.html"/><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Data Preparation | MixMatch PyTorch Documentation"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json"> { "@context": "http://schema.org", "@type": "WebPage", "@id": "/d/1.0/data-preparation.html#webpage", "url": "/d/1.0/data-preparation.html", "name": "Data Preparation | MixMatch PyTorch Documentation", "description": "", "image": "", "inLanguage":"en-US" }</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json"> { "@type": "WebSite", "@id": "/d/#website", "url": "/d/", "name": "MixMatch PyTorch Documentation Help" }</script><!-- End Schema.org --> <!-- Mermaid light/dark themes -->  <link rel="stylesheet" type="text/css" href="mermaid.css">  </head>     <body data-id="Data-Preparation" data-main-title="Data Preparation" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}"  data-template="article"  data-breadcrumbs="Pipeline"  >   <div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>MixMatch PyTorch Documentation 1.0 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="Data-Preparation"  id="Data-Preparation.md"  >Data Preparation</h1>  <p id="553210f9_2364">The data is split into 3 + K sets, where K is the number of augmentations.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 516.1666870117188 342.5" height="342.5" xmlns="http://www.w3.org/2000/svg" width="516.1666870117188" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M29.956939148164185,209.16666984558105L41.33043561317556,177.11111386617026C52.70393207818693,145.05555788675943,75.45092500820968,80.94444592793782,98.5362271347404,48.888889948527016C121.62152926127116,16.83333396911621,145.0451405843099,16.83333396911621,156.75694624582925,16.83333396911621L168.46875190734863,16.83333396911621"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-C" id="L-A-C-0" d="M38.91578537041046,209.16666984558105L48.79614079838078,198.02778085072836C58.67649622635111,186.88889185587564,78.43720708229176,164.61111386617026,100.1613125102621,153.47222487131754C121.88541793823242,142.33333587646484,145.57291793823242,142.33333587646484,157.41666793823242,142.33333587646484L169.26041793823242,142.33333587646484"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-D" id="L-A-D-0" d="M47.96875,226.00000381469727L56.340277989705406,226.00000381469727C64.71180597941081,226.00000381469727,81.45486195882161,226.00000381469727,98.19791793823242,226.00000381469727C114.94097391764323,226.00000381469727,131.68402989705405,226.00000381469727,140.05555788675943,226.00000381469727L148.42708587646484,226.00000381469727"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-E" id="L-A-E-0" d="M38.91578537041046,242.83333778381348L48.79614079838078,253.97222677866617C58.67649622635111,265.11111577351886,78.43720708229176,287.3888937632243,100.23422917692876,298.52778275807697C122.03125127156575,309.6666717529297,145.86458460489908,309.6666717529297,157.78125127156576,309.6666717529297L169.69791793823242,309.6666717529297"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-F" id="L-B-F-0" d="M214.7708339691162,16.83333396911621L227.55381997426352,16.83333396911621C240.3368059794108,16.83333396911621,265.9027779897054,16.83333396911621,289.8663199742635,16.83333396911621C313.8298619588216,16.83333396911621,336.19097391764325,16.83333396911621,347.371529897054,16.83333396911621L358.55208587646484,16.83333396911621"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-G" id="L-C-G-0" d="M213.97916793823242,132.96551442654143L226.89409828186035,127.55459567334263C239.80902862548828,122.14367692014383,265.63888931274414,111.32183941374622,288.7656256357829,105.91092066054743C311.8923619588216,100.50000190734863,332.31597391764325,100.50000190734863,342.527779897054,100.50000190734863L352.73958587646484,100.50000190734863"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-H" id="L-C-H-0" d="M213.97916793823242,151.70115732638826L226.89409828186035,157.11207607958707C239.80902862548828,162.52299483278586,265.63888931274414,173.34483233918345,287.9965279897054,178.75575109238227C310.3541666666667,184.16666984558105,329.2395833333333,184.16666984558105,338.6822916666667,184.16666984558105L348.125,184.16666984558105"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-I" id="L-C-I-0" d="M205.012548437388,159.16666984558105L219.42191536449002,177.27778116861978C233.83128229159198,195.38889249165854,262.650016145796,231.611115137736,287.20348071897547,249.72222646077475C311.75694529215497,267.8333377838135,332.0451405843099,267.8333377838135,342.1892382303874,267.8333377838135L352.33333587646484,267.8333377838135"></path></g><g class="edgeLabels"><g transform="translate(98.19791793823242, 16.83333396911621)" class="edgeLabel"><g transform="translate(-25.229167938232422, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="50.458335876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Shuffle</span></div></foreignObject></g></g><g transform="translate(98.19791793823242, 142.33333587646484)" class="edgeLabel"><g transform="translate(-25.229167938232422, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="50.458335876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Shuffle</span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(291.46875, 16.83333396911621)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.46875, 100.50000190734863)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.46875, 184.16666984558105)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(291.46875, 267.8333377838135)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(23.984375, 226.00000381469727)" id="flowchart-A-36492" class="node default default flowchart-label"><rect height="33.66666793823242" width="47.96875" y="-16.83333396911621" x="-23.984375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-16.484375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="32.96875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Data</span></div></foreignObject></g></g><g transform="translate(191.61979293823242, 16.83333396911621)" id="flowchart-B-36493" class="node default default flowchart-label"><rect height="33.66666793823242" width="46.30208396911621" y="-16.83333396911621" x="-23.151041984558105" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-15.651041984558105, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="31.30208396911621"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab.</span></div></foreignObject></g></g><g transform="translate(191.61979293823242, 142.33333587646484)" id="flowchart-C-36495" class="node default default flowchart-label"><rect height="33.66666793823242" width="44.71875" y="-16.83333396911621" x="-22.359375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-14.859375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="29.71875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl.</span></div></foreignObject></g></g><g transform="translate(191.61979293823242, 226.00000381469727)" id="flowchart-D-36497" class="node default default flowchart-label"><rect height="33.66666793823242" width="86.38542175292969" y="-16.83333396911621" x="-43.192710876464844" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-35.692710876464844, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="71.38542175292969"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Validation</span></div></foreignObject></g></g><g transform="translate(191.61979293823242, 309.6666717529297)" id="flowchart-E-36499" class="node default default flowchart-label"><rect height="33.66666793823242" width="43.84375" y="-16.83333396911621" x="-21.921875" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-14.421875, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="28.84375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Test</span></div></foreignObject></g></g><g transform="translate(424.14583587646484, 16.83333396911621)" id="flowchart-F-36501" class="node default default flowchart-label"><rect height="33.66666793823242" width="131.1875" y="-16.83333396911621" x="-65.59375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-58.09375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="116.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Augmented</span></div></foreignObject></g></g><g transform="translate(424.14583587646484, 100.50000190734863)" id="flowchart-G-36503" class="node default default flowchart-label"><rect height="33.66666793823242" width="142.8125" y="-16.83333396911621" x="-71.40625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-63.90625, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="127.8125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented 1</span></div></foreignObject></g></g><g transform="translate(424.14583587646484, 184.16666984558105)" id="flowchart-H-36505" class="node default default flowchart-label"><rect height="33.66666793823242" width="152.0416717529297" y="-16.83333396911621" x="-76.02083587646484" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-68.52083587646484, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="137.0416717529297"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented ...</span></div></foreignObject></g></g><g transform="translate(424.14583587646484, 267.8333377838135)" id="flowchart-I-36507" class="node default default flowchart-label"><rect height="33.66666793823242" width="143.625" y="-16.83333396911621" x="-71.8125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-64.3125, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="128.625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Augmented K</span></div></foreignObject></g></g></g></g></g></svg><p id="553210f9_2366">As our labelled data is tiny, it's important to stratify the data on the labels.</p><aside class="prompt" data-type="tip" data-title="" id="553210f9_2367"><p id="553210f9_2368">The implementation used K = 2.</p></aside><p id="553210f9_2369">It's up to the user to decide how to augment, how much labelled data to use, how much validation, etc.</p><section class="chapter"><h2 id="data-augmentation" data-toc="data-augmentation">Data Augmentation</h2><p id="553210f9_2370">The data augmentation is simple</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-8 -8 677.0208740234375 49.66666793823242" height="49.66666793823242" xmlns="http://www.w3.org/2000/svg" width="677.0208740234375" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M47.96875,16.83333396911621L52.135416666666664,16.83333396911621C56.302083333333336,16.83333396911621,64.63541666666667,16.83333396911621,72.96875,16.83333396911621C81.30208333333333,16.83333396911621,89.63541666666667,16.83333396911621,93.80208333333333,16.83333396911621L97.96875,16.83333396911621"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-C" id="L-B-C-0" d="M173.42708587646484,16.83333396911621L177.5937525431315,16.83333396911621C181.7604192097982,16.83333396911621,190.0937525431315,16.83333396911621,198.42708587646484,16.83333396911621C206.7604192097982,16.83333396911621,215.0937525431315,16.83333396911621,219.2604192097982,16.83333396911621L223.42708587646484,16.83333396911621"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-D" id="L-C-D-0" d="M397.11458587646484,16.83333396911621L401.28125254313153,16.83333396911621C405.44791920979816,16.83333396911621,413.78125254313153,16.83333396911621,422.11458587646484,16.83333396911621C430.44791920979816,16.83333396911621,438.78125254313153,16.83333396911621,442.94791920979816,16.83333396911621L447.11458587646484,16.83333396911621"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(23.984375, 16.83333396911621)" id="flowchart-A-36520" class="node default default flowchart-label"><rect height="33.66666793823242" width="47.96875" y="-16.83333396911621" x="-23.984375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-16.484375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="32.96875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Data</span></div></foreignObject></g></g><g transform="translate(135.69791793823242, 16.83333396911621)" id="flowchart-B-36521" class="node default default flowchart-label"><rect height="33.66666793823242" width="75.45833587646484" y="-16.83333396911621" x="-37.72916793823242" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-30.229167938232422, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="60.458335876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">4 px Pad</span></div></foreignObject></g></g><g transform="translate(310.27083587646484, 16.83333396911621)" id="flowchart-C-36523" class="node default default flowchart-label"><rect height="33.66666793823242" width="173.6875" y="-16.83333396911621" x="-86.84375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-79.34375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="158.6875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Random Crop 32x32px</span></div></foreignObject></g></g><g transform="translate(554.0677108764648, 16.83333396911621)" id="flowchart-D-36525" class="node default default flowchart-label"><rect height="33.66666793823242" width="213.90625" y="-16.83333396911621" x="-106.953125" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-99.453125, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="198.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Random Horizontal Flip 50%</span></div></foreignObject></g></g></g></g></g></svg></section><section class="chapter"><h2 id="implementation" data-toc="implementation">Implementation</h2><p id="553210f9_2372">We found some difficulty working with <code class="code" id="553210f9_2373">torchvision</code>'s CIFAR10 as the dataset is on-demand. We implement this approach, however, it's not the only way to do this.</p><p id="553210f9_2374">In order to stratify and shuffle the data without loading the entire dataset, we pass indices into the Dataset initialization, and pre-emptively shuffle and filter out the indices.</p><div class="code-block" data-lang="python"         >
from typing import Sequence

import numpy as np
from torchvision.datasets import CIFAR10


class CIFAR10Subset(CIFAR10):
    def __init__(self, idxs: Sequence[int], **kwargs):
        super().__init__(**kwargs)
        self.data = self.data[idxs]
        self.targets = np.array(self.targets)[idxs].tolist()
</div><p id="553210f9_2376">Notably, <code class="code" id="553210f9_2377">torchvision.datasets.CIFAR10</code> has</p><ul class="list _ul" id="553210f9_2378"    ><li class="list__item" id="553210f9_2379"><p>50,000 training images</p></li><li class="list__item" id="553210f9_2380"><p>10,000 test images</p></li></ul><p id="553210f9_2381">So, the process is to figure out how to split <code class="code" id="553210f9_2382">range(50000)</code> indices into the indices for the labelled and unlabelled data, furthermore, use the targets to stratify the data.</p><svg aria-roledescription="flowchart-v2" role="graphics-document document" viewBox="-7.999996185302734 -7.999998092651367 961.4453125 623.9426879882812" height="623.9426879882812" xmlns="http://www.w3.org/2000/svg" width="961.4453125" id="mermaid"><g><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="10" viewBox="0 0 12 20" class="marker flowchart" id="flowchart-pointEnd"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 0 L 10 5 L 0 10 z"></path></marker><marker orient="auto" markerHeight="12" markerWidth="12" markerUnits="userSpaceOnUse" refY="5" refX="0" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-pointStart"><path style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 0 5 L 10 10 L 10 0 z"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="11" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleEnd"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5" refX="-1" viewBox="0 0 10 10" class="marker flowchart" id="flowchart-circleStart"><circle style="stroke-width: 1; stroke-dasharray: 1, 0;" class="arrowMarkerPath" r="5" cy="5" cx="5"></circle></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="12" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossEnd"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><marker orient="auto" markerHeight="11" markerWidth="11" markerUnits="userSpaceOnUse" refY="5.2" refX="-1" viewBox="0 0 11 11" class="marker cross flowchart" id="flowchart-crossStart"><path style="stroke-width: 2; stroke-dasharray: 1, 0;" class="arrowMarkerPath" d="M 1,1 l 9,9 M 10,1 l -9,9"></path></marker><g class="root"><g class="clusters"></g><g class="edgePaths"><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-A LE-B" id="L-A-B-0" d="M463.5807285308838,144.13798904418945L463.5807285308838,148.3046557108561C463.5807285308838,152.4713223775228,463.5807285308838,160.8046557108561,469.50002002458774,169.13798904418945C475.41931151829175,177.4713223775228,487.25789450569965,185.8046557108561,493.17718599940366,189.9713223775228L499.09647749310756,194.13798904418945"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-C LE-B" id="L-C-B-0" d="M757.9244804382324,144.13798904418945L757.9244804382324,148.3046557108561C757.9244804382324,152.4713223775228,757.9244804382324,160.8046557108561,725.1714417139689,170.80396084006964C692.4184029897054,180.80326596928316,626.9123255411783,192.4685428943769,594.1592868169149,198.30118135692373L561.4062480926514,204.1338198194706"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D LE-C" id="L-D-C-0" d="M757.9244804382324,60.47132110595703L757.9244804382324,64.6379877726237C757.9244804382324,68.80465443929036,757.9244804382324,77.1379877726237,757.9244804382324,85.47132110595703C757.9244804382324,93.80465443929036,757.9244804382324,102.1379877726237,757.9244804382324,106.30465443929036L757.9244804382324,110.47132110595703"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-U" id="L-B-U-0" d="M484.6145839691162,217.62982819901896L450.8090279897054,223.49229966291944C417.0034720102946,229.35477112681994,349.39236005147296,241.0797140546209,315.5868040720622,253.34257328249842C281.78124809265137,265.605432510376,281.78124809265137,278.4062080383301,281.78124809265137,284.80659580230713L281.78124809265137,291.2069835662842"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-L" id="L-B-L-0" d="M523.0104160308838,227.80465698242188L523.0104160308838,231.97132364908853C523.0104160308838,236.13799031575522,523.0104160308838,244.47132364908853,523.0104160308838,255.03837807973227C523.0104160308838,265.605432510376,523.0104160308838,278.4062080383301,523.0104160308838,284.80659580230713L523.0104160308838,291.2069835662842"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-B LE-V" id="L-B-V-0" d="M561.4062480926514,217.66552789160676L594.9973945617676,223.52204940674264C628.5885410308838,229.37857092187846,695.7708339691162,241.09161395215017,729.3619804382324,253.3485232312631C762.9531269073486,265.605432510376,762.9531269073486,278.4062080383301,762.9531269073486,284.80659580230713L762.9531269073486,291.2069835662842"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D1 LE-S1" id="L-D1-S1-0" d="M644.0208339691162,338.2759780883789L644.0208339691162,342.4426447550456C644.0208339691162,346.6093114217122,644.0208339691162,354.9426447550456,649.9437568341909,363.2759780883789C655.8666796992655,371.6093114217122,667.712525429415,379.9426447550456,673.6354482944897,384.1093114217122L679.5583711595643,388.2759780883789"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-V LE-S1" id="L-V-S1-0" d="M762.9531269073486,324.8736515045166L762.9531269073486,331.27403926849365C762.9531269073486,337.6744270324707,762.9531269073486,350.4752025604248,757.0302040422739,361.04225699106854C751.1072811771992,371.6093114217122,739.2614354470498,379.9426447550456,733.3385125819751,384.1093114217122L727.4155897169005,388.2759780883789"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D2 LE-S2" id="L-D2-S2-0" d="M83.78385162353516,338.2759780883789L83.78385162353516,342.4426447550456C83.78385162353516,346.6093114217122,83.78385162353516,354.9426447550456,95.08116086324056,363.70013832679325C106.37847010294597,372.457631898541,128.97308858235678,381.6392857087032,140.27039782206217,386.23011261378423L151.56770706176758,390.8209395188653"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-U LE-S2" id="L-U-S2-0" d="M281.78124809265137,324.8736515045166L281.78124809265137,331.27403926849365C281.78124809265137,337.6744270324707,281.78124809265137,350.4752025604248,271.7994769414266,361.26866356105126C261.81770579020184,372.06212456167776,241.8541634877523,380.8482710349765,231.8723923365275,385.2413442716259L221.89062118530273,389.6344175082753"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-D3 LE-S3" id="L-D3-S3-0" d="M401.99999809265137,338.2759780883789L401.99999809265137,342.4426447550456C401.99999809265137,346.6093114217122,401.99999809265137,354.9426447550456,408.02641323702966,363.2759780883789C414.052828381408,371.6093114217122,426.1056586701646,379.9426447550456,432.13207381454293,384.1093114217122L438.1584889589212,388.2759780883789"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-L LE-S3" id="L-L-S3-0" d="M523.0104160308838,324.8736515045166L523.0104160308838,331.27403926849365C523.0104160308838,337.6744270324707,523.0104160308838,350.4752025604248,516.9840008865054,361.04225699106854C510.95758574212715,371.6093114217122,498.90475545337057,379.9426447550456,492.8783403089922,384.1093114217122L486.85192516461393,388.2759780883789"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S1 LE-VD" id="L-S1-VD-0" d="M703.4869804382324,421.9426460266113L703.4869804382324,426.109312693278C703.4869804382324,430.27597935994464,703.4869804382324,438.609312693278,703.4869804382324,449.7482016881307C703.4869804382324,460.8870906829834,703.4869804382324,474.83153533935547,703.4869804382324,490.3315356572469C703.4869804382324,505.83153597513837,703.4869804382324,522.8870919545492,703.4869804382324,537.1370922724406C703.4869804382324,551.387092590332,703.4869804382324,562.8315372467041,703.4869804382324,568.5537595748901L703.4869804382324,574.2759819030762"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S2 LE-UD" id="L-S2-UD-0" d="M186.72916412353516,421.9426460266113L186.72916412353516,426.109312693278C186.72916412353516,430.27597935994464,186.72916412353516,438.609312693278,186.72916412353516,446.9426460266113C186.72916412353516,455.27597935994464,186.72916412353516,463.609312693278,186.72916412353516,467.77597935994464L186.72916412353516,471.9426460266113"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-S3 LE-LD" id="L-S3-LD-0" d="M462.5052070617676,421.9426460266113L462.5052070617676,426.109312693278C462.5052070617676,430.27597935994464,462.5052070617676,438.609312693278,462.5052070617676,446.9426460266113C462.5052070617676,455.27597935994464,462.5052070617676,463.609312693278,462.5052070617676,467.77597935994464L462.5052070617676,471.9426460266113"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDA1" id="L-UD-UDA1-0" d="M139.78465728506663,505.60931396484375L123.82662391451679,511.3315362930298C107.86859054396695,517.0537586212158,75.95252380286726,528.4982032775879,59.99449043231741,539.94264793396C44.03645706176758,551.387092590332,44.03645706176758,562.8315372467041,44.03645706176758,568.5537595748901L44.03645706176758,574.2759819030762"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDA" id="L-UD-UDA-0" d="M186.72916412353516,505.60931396484375L186.72916412353516,511.3315362930298C186.72916412353516,517.0537586212158,186.72916412353516,528.4982032775879,186.72916412353516,539.94264793396C186.72916412353516,551.387092590332,186.72916412353516,562.8315372467041,186.72916412353516,568.5537595748901L186.72916412353516,574.2759819030762"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-UD LE-UDAK" id="L-UD-UDAK-0" d="M233.80903757131895,505.60931396484375L249.8130866530604,511.3315362930298C265.81713573480187,517.0537586212158,297.8252338982847,528.4982032775879,313.8292829800261,539.94264793396C329.8333320617676,551.387092590332,329.8333320617676,562.8315372467041,329.8333320617676,568.5537595748901L329.8333320617676,574.2759819030762"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-LD LE-LDA" id="L-LD-LDA-0" d="M462.5052070617676,505.60931396484375L462.5052070617676,511.3315362930298C462.5052070617676,517.0537586212158,462.5052070617676,528.4982032775879,462.5052070617676,539.94264793396C462.5052070617676,551.387092590332,462.5052070617676,562.8315372467041,462.5052070617676,568.5537595748901L462.5052070617676,574.2759819030762"></path><path marker-end="url(#flowchart-pointEnd)" style="fill:none;" class="edge-thickness-normal edge-pattern-solid flowchart-link LS-DT LE-DTT" id="L-DT-DTT-0" d="M893.8515644073486,60.47132110595703L893.8515644073486,64.6379877726237C893.8515644073486,68.80465443929036,893.8515644073486,77.1379877726237,893.8515644073486,88.2768767674764C893.8515644073486,99.4157657623291,893.8515644073486,113.36021041870117,893.8515644073486,127.30465507507324C893.8515644073486,141.2490997314453,893.8515644073486,155.19354438781738,893.8515644073486,169.13798904418945C893.8515644073486,183.08243370056152,893.8515644073486,197.0268783569336,893.8515644073486,210.97132301330566C893.8515644073486,224.91576766967773,893.8515644073486,238.8602123260498,893.8515644073486,255.03837807973227C893.8515644073486,271.21654383341473,893.8515644073486,289.62843068440753,893.8515644073486,308.0403175354004C893.8515644073486,326.45220438639325,893.8515644073486,344.86409123738605,893.8515644073486,361.04225699106854C893.8515644073486,377.220422744751,893.8515644073486,391.16486740112305,893.8515644073486,405.1093120574951C893.8515644073486,419.0537567138672,893.8515644073486,432.99820137023926,893.8515644073486,446.9426460266113C893.8515644073486,460.8870906829834,893.8515644073486,474.83153533935547,893.8515644073486,490.3315356572469C893.8515644073486,505.83153597513837,893.8515644073486,522.8870919545492,893.8515644073486,537.1370922724406C893.8515644073486,551.387092590332,893.8515644073486,562.8315372467041,893.8515644073486,568.5537595748901L893.8515644073486,574.2759819030762"></path></g><g class="edgeLabels"><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g class="edgeLabel"><g transform="translate(0, 0)" class="label"><foreignObject height="0" width="0"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel"></span></div></foreignObject></g></g><g transform="translate(44.03645706176758, 539.94264793396)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(186.72916412353516, 539.94264793396)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(329.8333320617676, 539.94264793396)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(462.5052070617676, 539.94264793396)" class="edgeLabel"><g transform="translate(-31.65625, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="63.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Augment</span></div></foreignObject></g></g><g transform="translate(893.8515644073486, 308.0403175354004)" class="edgeLabel"><g transform="translate(-40.29166793823242, -9.333333969116211)" class="label"><foreignObject height="18.666667938232422" width="80.58333587646484"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="edgeLabel">Train=False</span></div></foreignObject></g></g></g><g class="nodes"><g transform="translate(463.5807285308838, 127.30465507507324)" id="flowchart-A-36606" class="node default default flowchart-label"><rect height="33.66666793823242" width="71.21875" y="-16.83333396911621" x="-35.609375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-28.109375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="56.21875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">1-50000</span></div></foreignObject></g></g><g transform="translate(523.0104160308838, 210.97132301330566)" id="flowchart-B-36607" class="node default default flowchart-label"><rect height="33.66666793823242" width="76.7916669845581" y="-16.83333396911621" x="-38.39583349227905" ry="16.83333396911621" rx="16.83333396911621" style=""></rect><g transform="translate(-26.6875, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="53.375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Stratify</span></div></foreignObject></g></g><g transform="translate(757.9244804382324, 127.30465507507324)" id="flowchart-C-36608" class="node default default flowchart-label"><rect height="33.66666793823242" width="66.5" y="-16.83333396911621" x="-33.25" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-25.75, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="51.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Targets</span></div></foreignObject></g></g><g transform="translate(757.9244804382324, 30.235660552978516)" id="flowchart-D-36610" class="node default default flowchart-label"><path transform="translate(-34.76041793823242,-30.235658371130864)" d="M 0,8.934882934676434 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 a 34.76041793823242,8.934882934676434 0,0,0 -69.52083587646484 0 l 0,42.60155087290886 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 l 0,-42.60155087290886" style=""></path><g transform="translate(-27.260417938232422, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="54.520835876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(281.78124809265137, 308.0403175354004)" id="flowchart-U-36613" class="node default default flowchart-label"><rect height="33.66666793823242" width="70.91666793823242" y="-16.83333396911621" x="-35.45833396911621" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-27.95833396911621, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="55.91666793823242"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Idx</span></div></foreignObject></g></g><g transform="translate(523.0104160308838, 308.0403175354004)" id="flowchart-L-36615" class="node default default flowchart-label"><rect height="33.66666793823242" width="72.5" y="-16.83333396911621" x="-36.25" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-28.75, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="57.5"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Idx</span></div></foreignObject></g></g><g transform="translate(762.9531269073486, 308.0403175354004)" id="flowchart-V-36617" class="node default default flowchart-label"><rect height="33.66666793823242" width="68.34375" y="-16.83333396911621" x="-34.171875" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-26.671875, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="53.34375"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Val. Idx</span></div></foreignObject></g></g><g transform="translate(644.0208339691162, 308.0403175354004)" id="flowchart-D1-36618" class="node default default flowchart-label"><path transform="translate(-34.76041793823242,-30.235658371130864)" d="M 0,8.934882934676434 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 a 34.76041793823242,8.934882934676434 0,0,0 -69.52083587646484 0 l 0,42.60155087290886 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 l 0,-42.60155087290886" style=""></path><g transform="translate(-27.260417938232422, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="54.520835876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(703.4869804382324, 405.1093120574951)" id="flowchart-S1-36619" class="node default default flowchart-label"><rect height="33.66666793823242" width="70.3229169845581" y="-16.83333396911621" x="-35.16145849227905" ry="16.83333396911621" rx="16.83333396911621" style=""></rect><g transform="translate(-23.453125, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="46.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(83.78385162353516, 308.0403175354004)" id="flowchart-D2-36622" class="node default default flowchart-label"><path transform="translate(-34.76041793823242,-30.235658371130864)" d="M 0,8.934882934676434 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 a 34.76041793823242,8.934882934676434 0,0,0 -69.52083587646484 0 l 0,42.60155087290886 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 l 0,-42.60155087290886" style=""></path><g transform="translate(-27.260417938232422, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="54.520835876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(186.72916412353516, 405.1093120574951)" id="flowchart-S2-36623" class="node default default flowchart-label"><rect height="33.66666793823242" width="70.3229169845581" y="-16.83333396911621" x="-35.16145849227905" ry="16.83333396911621" rx="16.83333396911621" style=""></rect><g transform="translate(-23.453125, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="46.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(401.99999809265137, 308.0403175354004)" id="flowchart-D3-36626" class="node default default flowchart-label"><path transform="translate(-34.76041793823242,-30.235658371130864)" d="M 0,8.934882934676434 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 a 34.76041793823242,8.934882934676434 0,0,0 -69.52083587646484 0 l 0,42.60155087290886 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 l 0,-42.60155087290886" style=""></path><g transform="translate(-27.260417938232422, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="54.520835876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(462.5052070617676, 405.1093120574951)" id="flowchart-S3-36627" class="node default default flowchart-label"><rect height="33.66666793823242" width="70.3229169845581" y="-16.83333396911621" x="-35.16145849227905" ry="16.83333396911621" rx="16.83333396911621" style=""></rect><g transform="translate(-23.453125, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="46.90625"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Subset</span></div></foreignObject></g></g><g transform="translate(703.4869804382324, 591.1093158721924)" id="flowchart-VD-36631" class="node default default flowchart-label"><rect height="33.66666793823242" width="101.47917175292969" y="-16.83333396911621" x="-50.739585876464844" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-43.239585876464844, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="86.47917175292969"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Val. Dataset</span></div></foreignObject></g></g><g transform="translate(186.72916412353516, 488.77597999572754)" id="flowchart-UD-36633" class="node default default flowchart-label"><rect height="33.66666793823242" width="104.05208587646484" y="-16.83333396911621" x="-52.02604293823242" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-44.52604293823242, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="89.05208587646484"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Dataset</span></div></foreignObject></g></g><g transform="translate(462.5052070617676, 488.77597999572754)" id="flowchart-LD-36635" class="node default default flowchart-label"><rect height="33.66666793823242" width="105.63542175292969" y="-16.83333396911621" x="-52.817710876464844" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-45.317710876464844, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="90.63542175292969"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Dataset</span></div></foreignObject></g></g><g transform="translate(44.03645706176758, 591.1093158721924)" id="flowchart-UDA1-36637" class="node default default flowchart-label"><rect height="33.66666793823242" width="88.07292175292969" y="-16.83333396911621" x="-44.036460876464844" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-36.536460876464844, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="73.07292175292969"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug 1</span></div></foreignObject></g></g><g transform="translate(186.72916412353516, 591.1093158721924)" id="flowchart-UDA-36639" class="node default default flowchart-label"><rect height="33.66666793823242" width="97.3125" y="-16.83333396911621" x="-48.65625" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-41.15625, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="82.3125"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug ...</span></div></foreignObject></g></g><g transform="translate(329.8333320617676, 591.1093158721924)" id="flowchart-UDAK-36641" class="node default default flowchart-label"><rect height="33.66666793823242" width="88.89583587646484" y="-16.83333396911621" x="-44.44791793823242" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-36.94791793823242, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="73.89583587646484"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Unl. Aug K</span></div></foreignObject></g></g><g transform="translate(462.5052070617676, 591.1093158721924)" id="flowchart-LDA-36643" class="node default default flowchart-label"><rect height="33.66666793823242" width="76.44791793823242" y="-16.83333396911621" x="-38.22395896911621" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-30.72395896911621, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="61.44791793823242"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Lab. Aug</span></div></foreignObject></g></g><g transform="translate(893.8515644073486, 30.235660552978516)" id="flowchart-DT-36644" class="node default default flowchart-label"><path transform="translate(-34.76041793823242,-30.235658371130864)" d="M 0,8.934882934676434 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 a 34.76041793823242,8.934882934676434 0,0,0 -69.52083587646484 0 l 0,42.60155087290886 a 34.76041793823242,8.934882934676434 0,0,0 69.52083587646484 0 l 0,-42.60155087290886" style=""></path><g transform="translate(-27.260417938232422, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="54.520835876464844"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Dataset</span></div></foreignObject></g></g><g transform="translate(893.8515644073486, 591.1093158721924)" id="flowchart-DTT-36645" class="node default default flowchart-label"><rect height="33.66666793823242" width="103.1875" y="-16.83333396911621" x="-51.59375" ry="0" rx="0" style="" class="basic label-container"></rect><g transform="translate(-44.09375, -9.333333969116211)" style="" class="label"><rect></rect><foreignObject height="18.666667938232422" width="88.1875"><div style="display: inline-block; white-space: nowrap;" xmlns="http://www.w3.org/1999/xhtml"><span class="nodeLabel">Test Dataset</span></div></foreignObject></g></g></g></g></g></svg><aside class="prompt" data-type="note" data-title="" id="553210f9_2384"><p id="553210f9_2385">In total, 5 datasets are created, however, this shouldn't impact performance as they are all on-demand. Also note that only the test dataset has Train=False, the rest are all True.</p></aside><section class="chapter"><h3 id="splitting-unlabelled-to-k-augmentations" data-toc="splitting-unlabelled-to-k-augmentations">Splitting Unlabelled to K Augmentations</h3><p id="553210f9_2386">Instead of trying to create K datasets, we create a single dataset, and make it return K augmented versions of the same image.</p><div class="code-block" data-lang="python"         >
from typing import Sequence, Callable


class CIFAR10SubsetKAug(CIFAR10Subset):
    def __init__(self, k_augs: int, aug: Callable, idxs: Sequence[int], 
                 **kwargs):
        super().__init__(idxs=idxs, **kwargs)
        self.k_augs = k_augs
        self.aug = aug

    def __getitem__(self, item):
        img, target = super().__getitem__(item)
        return tuple(self.aug(img) for _ in range(self.k_augs)), target
</div><p id="553210f9_2388">This works by overriding the <code class="code" id="553210f9_2389">__getitem__</code> method, and returning a tuple of augmented images. Take note to update all downstream code to handle this.</p></section></section><div class="last-modified"> Last modified: 26 November 2023</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom">  <a class="navigation-links__prev" href="pipeline.html">Pipeline</a>   <a class="navigation-links__next" href="interleaving.html">Interleaving</a>  </div></article><div id="disqus_thread"></div></div></section></main></div>  <script src="https://resources.jetbrains.com/writerside/apidoc/6.1.5-b176/app.js"></script></body></html>